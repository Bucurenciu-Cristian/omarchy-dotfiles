#!/bin/bash
# Project Terminal - Opens terminal attached to current project's tmux session
# Syncs terminal context with project scratchpad system

set -euo pipefail

# Get current project info
PROJECT=$($HOME/.local/bin/project-scratchpad current)
TMUX_SESSION=$($HOME/.local/bin/project-scratchpad tmux-session)
PROJECT_DIR=$($HOME/.local/bin/project-scratchpad dir)

# Check if tmux session exists
if tmux has-session -t "$TMUX_SESSION" 2>/dev/null; then
    # Session exists - attach to it
    exec uwsm-app -- ghostty -e tmux attach-session -t "$TMUX_SESSION"
else
    # Session doesn't exist - create it in project directory
    exec uwsm-app -- ghostty -e tmux new-session -s "$TMUX_SESSION" -c "$PROJECT_DIR"
fi
